{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nimport { createDraft } from 'immer';\nconst initialState = {\n  quantity: 0,\n  orderPrice: 0,\n  userOrder: []\n};\nexport const orderSlice = createSlice({\n  name: 'order',\n  initialState,\n  reducers: {\n    orderAdd: (state, action) => {\n      const newOrder = createDraft({\n        ...action.payload\n      });\n      const order = state.userOrder.find(index => index.food_id === newOrder.food_id);\n      if (!order) {\n        state.userOrder.push({\n          ...newOrder,\n          quantity: 1,\n          price: state.orderPrice\n        });\n        state.orderPrice = state.userOrder.reduce((total, order) => total + Number(order.food_price), 0);\n      }\n      if (order) {\n        order.quantity = order.quantity + 1;\n        state.orderPrice += Number(order.food_price);\n        order.food_price = state.orderPrice;\n      }\n    },\n    orderRemove: (state, action) => {\n      const foodIdToDelete = action.payload;\n      const updatedUserOrder = state.userOrder.filter(order => order.food_id !== foodIdToDelete);\n      state.userOrder = updatedUserOrder;\n      state.orderPrice = state.userOrder.reduce((total, order) => total + Number(order.food_price), 0);\n    },\n    orderAllRemove: state => {\n      state.userOrder = [];\n      state.orderPrice = 0;\n    },\n    quantityAdd: (state, action) => {\n      const foodId = action.payload;\n      const order = state.userOrder.find(index => index.food_id === foodId);\n      if (order) {\n        order.quantity = order.quantity + 1;\n        state.orderPrice += Number(order.food_price);\n        order.food_id = state.orderPrice;\n      }\n    },\n    quantityLess: (state, action) => {\n      const foodId = action.payload;\n      const order = state.userOrder.find(index => index.food_id === foodId);\n      if (order) {\n        order.quantity = order.quantity - 1;\n        state.orderPrice -= Number(order.food_price);\n        order.food_price = state.orderPrice;\n      }\n      if ((order === null || order === void 0 ? void 0 : order.quantity) === 0) {\n        const foodIdToDelete = action.payload;\n        const updatedUserOrder = state.userOrder.filter(order => order.food_id !== foodIdToDelete);\n        state.userOrder = updatedUserOrder;\n        state.orderPrice = state.userOrder.reduce((total, order) => total + Number(order.food_price), 0);\n      }\n    }\n  }\n});\nexport const {\n  orderAdd,\n  orderRemove,\n  quantityAdd,\n  quantityLess,\n  orderAllRemove\n} = orderSlice.actions;\nexport default orderSlice.reducer;","map":{"version":3,"names":["createSlice","createDraft","initialState","quantity","orderPrice","userOrder","orderSlice","name","reducers","orderAdd","state","action","newOrder","payload","order","find","index","food_id","push","price","reduce","total","Number","food_price","orderRemove","foodIdToDelete","updatedUserOrder","filter","orderAllRemove","quantityAdd","foodId","quantityLess","actions","reducer"],"sources":["/home/and/Рабочий стол/Создать папку 6/frontend/src/store/orderSlice.ts"],"sourcesContent":["import { PayloadAction, createSlice } from '@reduxjs/toolkit'\nimport { foodType, orderType } from '../types'\nimport { createDraft } from 'immer'\n\nexport interface orderState {\n  quantity: number\n  orderPrice: number\n  userOrder: orderType[]\n}\n\nconst initialState: orderState = {\n  quantity: 0,\n  orderPrice: 0,\n  userOrder: [],\n}\n\nexport const orderSlice = createSlice({\n  name: 'order',\n  initialState,\n  reducers: {\n\n\n    orderAdd: (state, action: PayloadAction<foodType>) => {\n      const newOrder = createDraft({ ...action.payload })\n      const order = state.userOrder.find((index) => index.food_id === newOrder.food_id)\n\n      if (!order) {\n        state.userOrder.push({...newOrder,\n          quantity: 1,\n          price:state.orderPrice,\n        })\n        state.orderPrice = state.userOrder.reduce(\n          (total, order) => total + Number(order.food_price),0)\n      }\n\n      if (order) {\n        order.quantity = order.quantity + 1\n        state.orderPrice += Number(order.food_price)\n        order.food_price = state.orderPrice\n      }\n    },\n\n    orderRemove: (state, action: PayloadAction<number>) => {\n      const foodIdToDelete = action.payload\n      const updatedUserOrder = state.userOrder.filter((order) => order.food_id !== foodIdToDelete)\n      state.userOrder = updatedUserOrder\n      state.orderPrice = state.userOrder.reduce(\n        (total, order) => total + Number(order.food_price),\n        0,\n      )\n    },\n\n    orderAllRemove: (state) => {\n      state.userOrder = []\n      state.orderPrice = 0\n    },\n\n    quantityAdd: (state, action: PayloadAction<number>) => {\n      const foodId = action.payload\n\n      const order = state.userOrder.find((index) => index.food_id === foodId)\n\n      if (order) {\n        order.quantity = order.quantity + 1\n        state.orderPrice += Number(order.food_price)\n        order.food_id = state.orderPrice\n      }\n    },\n\n    quantityLess: (state, action: PayloadAction<number>) => {\n      const foodId = action.payload\n      const order = state.userOrder.find((index) => index.food_id === foodId)\n\n      if (order) {\n        order.quantity = order.quantity - 1\n        state.orderPrice -= Number(order.food_price)\n        order.food_price = state.orderPrice\n      }\n\n      if (order?.quantity === 0) {\n        const foodIdToDelete = action.payload\n        const updatedUserOrder = state.userOrder.filter((order) => order.food_id !== foodIdToDelete)\n        state.userOrder = updatedUserOrder\n        state.orderPrice = state.userOrder.reduce(\n          (total, order) => total + Number(order.food_price),\n          0,\n        )\n      }\n    },\n  },\n})\n\nexport const { orderAdd, orderRemove, quantityAdd, quantityLess, orderAllRemove } =\n  orderSlice.actions\n\nexport default orderSlice.reducer\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}